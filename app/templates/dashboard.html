{% extends "base.html" %}
{% block content %}
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
<div class="whole_page">
    <div class="user_header">
        <h1>Welcome, {{ User.first_name }}!</h1>
    </div>

    <div class="dashboard-content">
        <div class="quick-entry-form">
            <div class="card">
                <div class="card-header">
                    <h2>Quick Entry</h2>
                </div>
                <div class="card-body">       
                    <form method="POST" id="quickEntryForm" action="{{ url_for('views.quick_entry') }}">
                      <div class="journal-date-form">
                        <div class="form-item">
                          <label for="noteDate">Date:</label>
                          <input type="date" name="noteDate" id="noteDate" value="{{ today_date }}" required>
                        </div>
                        <div class="form-item">
                            <label for="tags">Description:</label>
                          <select  class="tags-description" name="tags" id="tags">
                            <option value="None">None</option>
                            <option value="Life Event">Life Event</option>
                            <option value="Milestone">Milestone</option>
                            <option value="Setback">Setback</option>
                            <option value="Consult">Consult</option>
                            <option value="Question">Question</option>
                            <option value="Good">Good</option>
                            <option value="Neutral">Neutral</option>
                            <option value="Entry">Entry</option>
                          </select>
                          </div>
                        </div>
                        <button id="foodTag">Food</button>
                        <div id="foodForm" style="display: none;">
                          <div class="form-item">
                              <label for="meal_name">Meal Name:</label>
                              <input type="text" name="meal_name" id="meal_name" class="form-control">
                          </div>
                          <div class="form-item">
                              <label for="meal_description">Meal Description:</label>
                              <textarea name="meal_description" id="meal_description" class="form-control" style="height: 150px;"></textarea>
                          </div>
                      </div>
                        </div>
                        <div class="notes">
                          <label for="note">Notes:</label>
                          <textarea name="note" id="note" class="form-control" style="height: 150px; width: 100%;"></textarea>
                        </div>
                        <div class="mood">
                          <label for="mood">Mood Check-In (1 to 10):</label>
                          <div>
                            <span class='mood-score' id="moodScore"></span>
                            <input  type="range" class="mood-range" name="mood" id="mood" min="1" max="10" step="1" oninput="updateMoodTags()">
                          </div> 
                          <div class="mood-tags">     
                          <label for="moodTags">Tags:</label>
                          <div id="moodTagsCheckboxes" class="mood-tags-container"></div>
                          </div>
                          <br>
                        </div>
                      <hr/>
                      <br>
                      <div class="button-container">
                        <button type="submit" class="myButton">Save Quick Entry</button>
                      </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="step-checker">
            <div class="card">
                <div class="card-header">
                    <h2>Step Checker</h2>
                </div>
                <div class="card-body">
                    <div class="step" id="step1" onclick="toggleCompletion('step1')">
                        <span>Step 1: Diary Entry Completion</span>
                        <div class="check-mark"></div>
                    </div>
                    <div class="step" id="step2" onclick="toggleCompletion('step2')">
                        <span>Step 2: Schedule Your Day Completion</span>
                        <div class="check-mark"></div>
                    </div>
                    <div class="step" id="step3" onclick="toggleCompletion('step3')">
                        <span>Step 3: Review Data</span>
                        <div class="check-mark"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Suggestion Box -->
        <div class="suggestion-box">
            <div class="card">
                <div class="card-header">
                    <h2>Suggestions</h2>
                </div>
                <div class="card-body">
                    {% if suggestions %}
                    <ul>
                        {% for note, note_suggestions in suggestions %}
                        <li>
                            <h3>Note: {{ note.date }}</h3>
                            <p>{{ note.note }}</p>
                            <ul>
                                {% for suggestion in note_suggestions %}
                                <li>{{ suggestion }}</li>
                                {% endfor %}
                            </ul>
                        </li>
                        {% endfor %}
                    </ul>
                    {% else %}
                    <p>No suggestions available.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleCompletion(stepId) {
            var stepElement = document.getElementById(stepId);
            var checkMarkElement = stepElement.querySelector('.check-mark');

            if (stepElement.classList.contains('completed')) {
                stepElement.classList.remove('completed');
                checkMarkElement.style.backgroundColor = 'transparent'; 
            } else {
                stepElement.classList.add('completed');
                checkMarkElement.style.backgroundColor = '#482973'; 
            }
        }

        function toggleFoodForm() {
          var foodForm = document.getElementById('foodForm');
          if (foodForm.style.display === 'none') {
              foodForm.style.display = 'block';
          } else {
              foodForm.style.display = 'none';
          }
      }
  
      // Add event listener to the "food" tag
      document.getElementById('foodTag').addEventListener('click', function() {
          toggleFoodForm();
      });
    </script>
</div>
</body>
{% endblock %}
